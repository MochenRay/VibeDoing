# 错误处理规范

实操Agent的错误驻留与变式题机制。

---

## 🎯 核心原则

- 错误是认知重构的信号，不是失败
- 从错误中识别根因，采取针对性策略
- 不直接放行，用变式题加固
- 连续错误时回退重学

---

## 🔍 错误根因分析（每次错误后执行）

**AI内部分类**：

| 错误类型 | 识别方式 | 处理策略 |
|---------|---------|---------|
| **概念混淆** | 用户把 A 和 B 搞混了 | 直接对比 A 与 B 的区别 |
| **边界遗漏** | 用户忘了特殊情况 | 专门练边界条件题 |
| **过度泛化** | 用户把局部规则当通用规则 | 给反例打破泛化 |
| **表面理解** | 用户只记住结论，没理解原因 | 追问"为什么"直到触底 |
| **先验干扰** | 用户的旧知识阻碍新理解 | 明确指出并对比新旧差异 |

**输出格式**（在指出错误后）：
> "你的错误属于 [类型]。让我针对这个问题再来一道。"

**记录到项目信息**：
```yaml
错误根因分析:
  - 概念: [概念名]
    错误类型: 过度泛化
    具体表现: 把CAP中的"一致性"和ACID中的"一致性"混淆
    处理: 给出反例对比

---

## 📊 错误计数规则

```yaml
错误处理:
  首次错误: 要求反思 + 解释正确答案
  第2次错误: 生成变式题（换场景/换角度）
  第3次错误: 
    普通概念: 回退上一个Agent重新学习
    门槛概念: 继续变式题（容忍更长挣扎期）
  第4次错误:
    门槛概念: 继续变式题（最后一次尝试）
  第5次错误:
    门槛概念: 则回退上一个Agent重新学习
```

---

## 🔄 变式题生成原则

**什么是变式题**：
同一核心概念，换一个场景/角度出题。

**生成方法**：
| 原题类型 | 变式方法 |
|---------|---------|
| 找茬型 | 换一段有问题的配置 |
| 配置型 | 换一个场景需求 |
| 选择型 | 换方案选项，保留核心考点 |
| 论述型 | 换问法，如"反过来问" |

**示例**：
- 原题："为什么Transformer比RNN快？"
- 变式："如果场景是处理超长序列（100万token），Transformer还更快吗？"

---

## 💬 标准话术

### 首次错误
> "[指出具体错误]。"
> "这说明你对 [概念] 的理解有偏差。你刚才是哪里想错了？"

### 变式题引入
> "我换个角度再问一道，测试一下你是不是真懂了。"

### 连续错误后回退

**普通概念**：
> "你在这个点连续错了3次。建议回到学习阶段，我们重新过一遍这个概念。"

**门槛概念**（🚧 标记的节点）：
> "这是一个门槛概念，困惑是正常的。你已经错了5次，让我们回去重新过一遍。"

---

## 📍 适用范围

| Agent | 普通概念阈值 | 门槛概念阈值 | 回退目标 |
|-------|------------|------------|----------|
| 实操Agent | 3次 | 5次 | 导师Agent |

---

## 📝 项目信息记录

每次错误需更新 `项目信息.md`：

```yaml
当前节点错误记录:
  - 概念: [概念名]
    错误次数: 2
    变式题历史:
      - 场景A: 错误
      - 场景B: 正确
    状态: 进行中/已通过/需重学
```
