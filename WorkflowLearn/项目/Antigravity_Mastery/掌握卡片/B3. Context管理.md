# 掌握卡片：B3. Context管理

## 🧠 我的理解
- **Context定义**：Agent 能"看到"的全部信息，决定了它的决策基础
- **上下文结构（信件类比）**：
  1. 开头是 GEMINI.md（最高优先级，始终保留）
  2. 之前的对话消息（超长会被截断）
  3. 用户最新回复（最高优先级）
- **GEMINI.md 加载时机**：会话开始时加载，始终在上下文最开头，不是动态加载
- **上下文窗口限制**：超长会牺牲最前面的对话
- **主动管理策略**：系统层（GEMINI.md）+ 任务层（提示词明确）+ 即时层（@引用文件）

## 🔗 类比挂钩
**"信件结构"**
- 每次对话 = 一封信
- 信的开头固定是 GEMINI.md
- 中间是对话历史
- 结尾是用户最新消息

**"分层规则体系"**
- 全局规则 → GEMINI.md
- 项目规则 → 项目级配置文件
- 把重要信息放在正确的位置

## ⚠️ 常见误区
- **"Agent 能看到整个项目"**：它只能看到你喂给它的 + 它主动读取的
- **"我说过了它应该记得"**：长对话中早期内容可能被冲掉
- **"越多信息越好"**：太多无关信息会干扰判断

## 🚫 我的错误记录
- （本节点无错误记录）

## 💡 验证高光

### 掌握验证：Agent "忘记"早期规则
**场景**：对话50多轮后，Agent 忘记了早期的规则

**分析**：
- 原因：没有固化到规则文件，被上下文截断了
- 解决：区分全局规则 vs 项目规则，写入对应文件

**分层思维**：
- 全局/永久规则 → GEMINI.md
- 项目级规则 → 项目配置文件

## 📖 源真理定义
> **Context（上下文）**：Agent 在任何时刻可以"看到"的全部信息。包括系统提示（GEMINI.md）、对话历史、工具返回、工作区文件。上下文窗口有限，需要主动管理：把重要信息放在正确的位置。

## 🧱 关联知识
- **前置节点**：[[B2. Tool Calling]]
- **后置节点**：[[B4. Artifacts系统]]
- **相关概念**：GEMINI.md, System Prompt, Context Truncation

## 💪 实操挑战
已完成：Agent "忘记"早期规则场景分析

---
status: mastered
mastered_date: 2026-01-11
review_count: 1
last_review: 2026-01-11
next_review: 2026-01-12
---
